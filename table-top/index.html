<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>2D responsive demo</title>
    <script src="../dist/mr.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css" />
</head>

<body>
    <mr-app debug="false">
        <mr-light color="blue" intensity="2" data-position="0 0 0.5"></mr-light>
        <mr-light color="orange" intensity="1" data-position="0 1 0.5"></mr-light>
        <!-- <mr-panel class="stack" data-comp-anchor="type: fixed;">

            <mr-div class="nav">
                <mr-div style="height: 72px; width: 144px;" onclick="App.spinLogo()">
                    <mr-model id="mrjs-logo" src="./assets/mrjs_logo.glb"></mr-model>
                </mr-div>
                <mr-button style="margin-left: auto;" onclick="launchTableTopExperience()">MR</mr-button>
                <mr-button style="margin-left: 10px;" onclick="App.prev()">◁</mr-button>
                <mr-button style="margin-left: 10px" onclick="App.next()">▷</mr-button>
            </mr-div>

            <mr-div class="illustration">
                <mr-div id="models" style="z-index: 100"></mr-div>
            </mr-div>

            <mr-div class="information">
                <mr-div class="tight-stack">
                    <mr-text id="name">loading</mr-text>
                    <mr-text id="order">loading</mr-text>
                </mr-div>
                <mr-text id="desc">loading</mr-text>
            </mr-div>

        </mr-panel> -->

            <mr-volume id="whale" data-comp-anchor="type: plane; label: table;">
                <mr-aquarium id="aquarium"></mr-aquarium>
                <mr-model 
                    data-position="0 0.25 0"
                    style="scale: 0.05" src="./assets/whale_anim_centered.glb">
                </mr-model>
            </mr-volume>
    </mr-app>
</body>

<script>
    let whale = document.getElementById('whale')
    let xrButton = document.getElementById('xr-button')

    // whale.object3D.visible = false

    function launchTableTopExperience() {
        whale.object3D.visible = !whale.object3D.visible
    }

    /*********** begin: mr-aquarium entity ***********/

    class MRAquarium extends MREntity {

        constructor() {
            super()

            const params = {
                color: '#00ccff',
                scale: 0.25,
                flowX: 0.5,
                flowY: 0.5
            };

            const geometry = new THREE.BoxGeometry(0.9, 0.9, 0.9);
            const material = new THREE.MeshStandardMaterial({color: 0x00ccff, side: 2, transparent: true, opacity: 0.2, metalness: 1})
            this.mesh = new THREE.Mesh(geometry, material)

            this.object3D.add(this.mesh)
            
            this.mesh.material.clipping = true;

        }
}

customElements.get('mr-aquarium') || customElements.define('mr-aquarium', MRAquarium);


/*********** end: mr-aquarium entity ***********/



    let aquarium = document.getElementById('aquarium')

    document.addEventListener('anchored', (e) => {
        console.log(e.target.plane);
        console.log(e.target == aquarium.parentElement);

        if (e.target == aquarium.parentElement && e.target.plane) {
            let width = e.target.plane.dimensions.x - 0.01
            let depth = e.target.plane.dimensions.z - 0.01
            let height = width > depth ? width : depth
            height /= 1.5
            aquarium.mesh.geometry.copy(new THREE.BoxGeometry(width, height, depth))
        }
    })


</script>
<script src="script.js"></script>


</html>